{
  "$schema": "https://playground.wordpress.net/blueprint-schema.json",
  "preferredVersions": {
    "php": "8.3",
    "wp": "latest"
  },
  "steps": [
    {
      "step": "login",
      "username": "admin",
      "password": "password"
    },
    {
      "step": "installTheme",
      "themeZipFile": {
        "resource": "wordpress.org/themes",
        "slug": "twentytwentyfive"
      }
    },
    {
      "step": "runPHP",
      "code": "<?php\n require_once('/wordpress/wp-load.php'); $seed = isset($_GET['seed']) ? sanitize_text_field($_GET['seed']) : time();\ndefine('PROC_SEED', $seed);\n\n// Create page\nwp_insert_post([\n  'post_title' => 'Pattern Lab #' . $seed,\n  'post_content' => '<!-- wp:paragraph --><p><strong>Seed: ' . $seed . '</strong> â€” <a href=\"?seed=' . (time() + rand(1,999)) . '\">Regenerate</a></p><!-- /wp:paragraph -->',\n  'post_status' => 'publish',\n  'post_type' => 'page',\n  'post_name' => 'pattern-lab-generated'\n]);\n\n//    add_action( 'init', function(){  register_block_pattern_category ( 'procedural', array( 'label' => _x( 'Features', 'Block pattern category', 'nelio' ) )); }); Run only once\nif (!get_option('proc_patterns_done_' . $seed)) {\n  update_option('proc_patterns_done_' . $seed, '1');\n\n  add_action('admin_enqueue_scripts', function() {\n    $js = \"<script>\n    document.addEventListener('DOMContentLoaded', () => {\n      const checkGutenberg = setInterval(() => {\n        if (window.wp?.blocks?.registerBlockPattern && window.wp?.data?.select('core/block-editor')) {\n          clearInterval(checkGutenberg);\n          registerPatterns();\n        }\n      }, 300);\n\n      function registerPatterns() {\n        const seed = '\" . PROC_SEED . \"';\n        let r = parseInt(seed) % 2147483647 || 12345;\n        function rng() { r = (r * 16807) % 2147483647; return r / 2147483647; }\n\n        const p = [{bg:'#1a1a2e',a:'#00ff88'},{bg:'#16213e',a:'#ff6b6b'},{bg:'#0f3460',a:'#e94560'}][Math.floor(rng()*3)];\n        const w = ['Cosmos','Nebula','Void','Pulse','Echo','Flux'];\n        const { createBlock, serialize, registerBlockPattern } = wp.blocks;\n\n        for(let i=0; i<10; i++){\n          const type = Math.floor(rng()*3);\n          const typeName = type === 0 ? 'Hero' : (type === 1 ? 'Grid' : 'Quote');\n          let blocks;\n          if(type===0){\n            blocks = [createBlock('core/cover', {url:`https://source.unsplash.com/1800x1000/?abstract&sig=${Math.floor(rng()*1000)}`,dimRatio:60,minHeight:90,minHeightUnit:'vh',style:{color:{background:p.bg}}}, [\n              createBlock('core/group',{layout:{type:'constrained'}},[\n                createBlock('core/heading',{content:w[Math.floor(rng()*6)]+' '+w[Math.floor(rng()*6)],level:1,textColor:'white',fontSize:'xx-large'}),\n                createBlock('core/paragraph',{content:'Seed: '+seed,textColor:'white'}),\n                createBlock('core/buttons',{},[createBlock('core/button',{text:'Explore',backgroundColor:p.a,textColor:'white'})])\n              ])\n            ])];\n          } else if(type===1){\n            const c=2+Math.floor(rng()*2);\n            const cols=Array.from({length:c},()=>[\n              createBlock('core/image',{url:`https://source.unsplash.com/600x600/?art&sig=${Math.floor(rng()*1000)}`}),\n              createBlock('core/heading',{content:'Card '+Math.floor(rng()*100),level:3}),\n              createBlock('core/paragraph',{content:'Auto.'})\n            ]);\n            blocks = [createBlock('core/columns',{isStackedOnMobile:true},cols)];\n          } else {\n            blocks = [createBlock('core/pullquote',{value:['Code is poetry.','Seed it.','Art.'][Math.floor(rng()*3)],citation:'Engine',style:{color:{background:p.bg,text:'#fff'}}})];\n          }\n          const id = `proc/pat-${seed}-${i}`;\n          registerBlockPattern(id, {\n            title: `Proc ${typeName} #${i+1}`,\n            content: serialize(blocks),\n            categories: ['procedural']\n          });\n        }\n        console.log('Procedural patterns registered!');\n      }\n    });\n    </script>\";\n\n    wp_add_inline_script('wp-blocks', $js);\n  });\n\n  wp_redirect(admin_url('post-new.php?post_type=page'));\n  exit;\n}\n\nwp_redirect(home_url('/pattern-lab-generated'));\nexit;\n?>"
    }
  ]
}
